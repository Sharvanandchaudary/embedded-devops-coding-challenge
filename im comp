‚úÖ STEP 1: Run These Commands on the Working rhel8.6-vsaravan-sshbaremetaliso

Please run the following commands inside the working VM:

uname -r
rpm -qa | grep kernel
cat /etc/fstab
blkid
[ -d /sys/firmware/efi ] && echo "UEFI" || echo "BIOS"
lsblk
df -h
lsinitrd /boot/initramfs-$(uname -r).img | wc -l
lsinitrd /boot/initramfs-$(uname -r).img > /tmp/initramfs-working.txt
cat /etc/dracut.conf
ls /etc/dracut.conf.d/
cat /etc/dracut.conf.d/* 2>/dev/null


This will show:

Boot mode

Kernel version

What drivers are in initramfs

If dracut.conf or standard scripts changed anything

If anything was stripped from initramfs

‚úÖ STEP 2: Do the Same on the Cadence Standard (Failing) Image

Also run on the failing image (built with Cadence standardization script):

uname -r
rpm -qa | grep kernel
cat /etc/fstab
blkid
[ -d /sys/firmware/efi ] && echo "UEFI" || echo "BIOS"
lsblk
df -h
lsinitrd /boot/initramfs-$(uname -r).img | wc -l
lsinitrd /boot/initramfs-$(uname -r).img > /tmp/initramfs-failing.txt
cat /etc/dracut.conf
ls /etc/dracut.conf.d/
cat /etc/dracut.conf.d/* 2>/dev/null

‚úÖ STEP 3: Compare the Two

You can now either:

diff both initramfs-*.txt and dracut.conf files

Share the outputs here for me to compare

You‚Äôre specifically checking for:

Differences in included drivers

hostonly=yes in dracut.conf (which limits initramfs to current VM hardware)

Anything omitted in the Cadence Standard image




‚úÖ Check for Each Driver Module:
DRIVERS="xfs ext4 ahci ata_piix sd_mod virtio_blk virtio_scsi"
for mod in $DRIVERS; do
    echo -n "$mod: "; find /lib/modules/$(uname -r)/kernel/drivers/ -name "$mod.ko*" | head -n 1
done

üîç Sample Output:
xfs: /lib/modules/4.18.0-425.19.2.el8_7.x86_64/kernel/fs/xfs/xfs.ko.xz
ext4: /lib/modules/4.18.0-425.19.2.el8_7.x86_64/kernel/fs/ext4/ext4.ko.xz
ahci: /lib/modules/.../ata/ahci.ko.xz
ata_piix: /lib/modules/.../ata/ata_piix.ko.xz
sd_mod: /lib/modules/.../scsi/sd_mod.ko.xz
virtio_blk: /lib/modules/.../virtio/virtio_blk.ko.xz
virtio_scsi: /lib/modules/.../virtio/virtio_scsi.ko.xz

üìå What You‚Äôre Looking For:

If any of these lines are blank, that module is missing from the kernel modules directory ‚Äî and needs to be added explicitly using --add-drivers when running dracut.

Let me know the outputs from both VMs ‚Äî and I‚Äôll tell you which modules are missing from the failing one and confirm the dracut fix.
